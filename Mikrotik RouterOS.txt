

    Creado por Usuario desconocido (emils), actualizado por última vez por Matīss O. el abr 14, 2025 10 min de lectura

    Summary
    User Profiles
    User Database
    Active Users
    Remote AAA
    Examples
        Add new profile
        Add new user

Summary

Sub-menu: /ppp

The MikroTik RouterOS provides scalable Authentication, Authorization, and Accounting (AAA) functionality.

Local authentication is performed using the User Database and the Profile Database. The actual configuration for the given user is composed using the respective user record from the User Database, the associated item from the Profile Database, and the item in the Profile database which is set as default for a given service the user is authenticating to. Default profile settings from the Profile database have the lowest priority while the user access record settings from the User Database have the highest priority with the only exception being particular IP addresses take precedence over IP pools in the local-address and remote-address settings, which are described later on.

Support for RADIUS authentication gives the ISP or network administrator the ability to manage PPP user access and accounting from one server throughout a large network. The MikroTik RouterOS has a RADIUS client that can authenticate for PPP, PPPoE, PPTP, L2TP, OPVN, and ISDN connections. The attributes received from the RADIUS server override the ones set in the default profile, but if some parameters are not received they are taken from the respective default profile.
User Profiles

Sub-menu: /ppp profile

PPP profiles are used to define default values for user access records stored under /ppp secret submenu. Settings in /ppp secret User Database overrides corresponding /ppp profile settings except that single IP addresses always take precedence over IP pools when specified as local-address or remote-address parameters.

Properties
address-list (string; Default: )	Address list name to which ppp assigned (on server) or received (on client) address will be added.
bridge (string; Default: )	Name of the bridge  interface to which ppp interface will be added as a slave port. Both tunnel endpoints (server and client) must be in the bridge to make this work, see more details in the BCP bridging manual.
bridge-horizon (integer 0..429496729; Default: )	Used split-horizon value for the dynamically created bridge port. Can be used to prevent bridging loops and isolate traffic. Set the same value for a group of ports, to prevent them from sending data to ports with the same horizon value.
bridge-learning (default | no | yes; Default: default)	Changes MAC learning behavior on the dynamically created bridge port:

    yes - enables MAC learning
    no - disables MAC learning
    default - derive this value from the interface default profile; same as yes if this is the interface default profile

bridge-path-cost (integer 1..200000000; Default: )	Used path cost for the dynamically created bridge port, used by STP/RSTP to determine the best path, used by MSTP to determine the best path between regions. This property has no effect when a bridge protocol-mode is set to none.
bridge-port-priority (integer 0..240; Default: )	Used priority for the dynamically created bridge port, used by STP/RSTP to determine the root port, used by MSTP to determine the root port between regions. This property has no effect when a bridge protocol-mode is set to none.
bridge-port-vid (integer 1..4094; Default: 1)	Used to assign PVID parameter for dynamically created interface. This property only has an effect when bridge vlan-filtering is set to yes.
bridge-port-trusted ( no | yes; Default: no)	Used to set dynamically created interface as DHCP trusted.
change-tcp-mss (yes | no | default; Default: no)	Modifies connection MSS settings (applies only for IPv4):

    yes - adjust connection MSS value
    no - do not adjust connection MSS value
    default - derive this value from the interface default profile; same as no if this is the interface default profile

comment (string; Default: )	Profile comment
dhcpv6-lease-time (string; Default: )	Lease time can be set starting from 7.20ab202, by default time is set to 1d.
dhcpv6-pd-pool (string; Default: )	Name of the IPv6 pool which will be used by dynamically created DHCPv6 server when client connects. Read more >>
dns-server (IP; Default: )	IP address of the DNS server that is supplied to PPP clients
idle-timeout (time; Default: )	Specifies the amount of time after which the link will be terminated if there is no activity present. Timeout is not set by default
incoming-filter (string; Default: )	Firewall chain name for incoming packets. The specified chain gets control of each packet coming from the client. The ppp chain should be manually added and rules with action=jump jump-target=ppp should be added to other relevant chains for this feature to work. For more information look at the examples section
insert-queue-before (bottom | first | queue name ; Default: )	Inserts new queue as the last, first, or before a specified queue
interface-list (interface list name; Default: )	Specifies interface list to which profile interfaces will be added
local-address (IP address | pool; Default: )	Tunnel address or name of the pool from which the address is assigned to ppp interface locally
name (string; Default: )	PPP profile name
on-up (script; Default: )	Execute script on user login-event. These are available variables that are accessible for the event script:

    user
    local-address
    remote-address
    caller-id
    called-id
    interface

The interface variable will return interface id value, not interface name.
on-down (script; Default: )	Execute script on the user logging off. See on-up for more details
only-one (yes | no | default; Default: default)	Defines whether a user is allowed to have more than one ppp session at a time

    yes - a user is not allowed to have more than one ppp session at a time
    no - the user is allowed to have more than one ppp session at a time
    default - derive this value from the interface default profile; same as no if this is the interface default profile

outgoing-filter (string; Default: )	Firewall chain name for outgoing packets. The specified chain gets control for each packet going to the client. The PPP chain should be manually added and rules with action=jump jump-target=ppp should be added to other relevant chains for this feature to work. For more information look at the Examples section.
parent-queue (none | queue name; Default: )	Specifies parent queue 

queue-type (default | ethernet-default | wireless-default | synchronous-default |  hotspot-default | pcq-upload-default | pcq-download-default | only-hardware-queue | multi-queue-ethernet-default | default-small | custom queue type name ; Default: )
	Specifies queue type. Starting from 7.19 it is possible to specify queue type for rx/tx separately, clients "upload" and "download". Use / to configure separate queue type, first is rx queue type, and then tx queue type.
rate-limit (string; Default: )	Rate limitation in form of rx-rate[/tx-rate] [rx-burst-rate[/tx-burst-rate] [rx-burst-threshold[/tx-burst-threshold] [rx-burst-time[/tx-burst-time] [priority] [rx-rate-min[/tx-rate-min]]]] from the point of view of the router (so "rx" is client upload, and "tx" is client download). All rates are measured in bits per second, unless followed by an optional 'k' suffix (kilobits per second) or 'M' suffix (megabits per second). If tx-rate is not specified, rx-rate serves as tx-rate too. The same applies to tx-burst-rate, tx-burst-threshold and tx-burst-time. If both rx-burst-threshold and tx-burst-threshold are not specified (but burst-rate is specified), rx-rate and tx-rate are used as burst thresholds. If both rx-burst-time and tx-burst-time are not specified, 1s is used as default. Priority takes values 1..8, where 1 implies the highest priority, but 8 - the lowest. If rx-rate-min and tx-rate-min are not specified rx-rate and tx-rate values are used. The rx-rate-min and tx-rate-min values can not exceed rx-rate and tx-rate values.
remote-address (IP; Default: )	Tunnel address or name of the pool from which address is assigned to remote ppp interface.
remote-ipv6-prefix-pool (string | none; Default: none)	Assign a prefix from the IPv6 pool to the client and install the corresponding IPv6 route.
session-timeout (time; Default: )	Maximum time the connection can stay up. By default, no time limit is set.
use-compression (yes | no | default; Default: default)	Specifies whether to use data compression or not.

    yes - enable data compression
    no - disable data compression
    default - derive this value from the interface default profile; same as no if this is the interface default profile

This setting does not affect OVPN tunnels.
use-encryption (yes | no | default | require; Default: default)	Specifies whether to use data encryption or not.

    yes - enable data encryption
    no - disable data encryption
    default - derive this value from the interface default profile; same as no if this is the interface default profile
    require - explicitly requires encryption

This setting does not work on OVPN and SSTP tunnels.
use-ipv6 (yes | no | default | require; Default: default)	Specifies whether to allow IPv6. By default is enabled if IPv6 package is installed.

    yes - enable IPv6 support
    no - disable IPv6 support
    default - derive this value from the interface default profile; same as no if this is the interface default profile
    require - explicitly requires IPv6 support

use-mpls (yes | no | default | require; Default: default)	Specifies whether to allow MPLS over PPP.

    yes - enable MPLS support
    no - disable MPLS support
    default - derive this value from the interface default profile; same as no if this is the interface default profile
    require - explicitly requires MPLS support

use-upnp (yes | no | default ; Default: default)	

Specifies whether to allow UPnP 

    yes - enable UPnP 
    no - disable UPnP 
    default - derive this value from the interface default profile; same as no if this is the interface default profile

wins-server (IP address; Default: )	IP address of the WINS server to supply to Windows clients

Notes

The two default profiles cannot be removed:
[admin@rb13] ppp profile> print
Flags: * - default
 0 * name="default" use-compression=no use-encryption=no only-one=no
     change-tcp-mss=yes
 1 * name="default-encryption" use-compression=default use-encryption=yes
     only-one=default change-tcp-mss=default
[admin@rb13] ppp profile>

incoming-filter and outgoing-filter arguments add dynamic jump rules to chain ppp, where the jump-target argument will be equal to incoming-filter or outgoing-filter argument in the profile. Therefore, chain ppp should be manually added before changing these arguments.

only-one parameter is ignored if RADIUS authentication is used.
PPP tunnels uses LCP protocol for MTU negotiation, it happens right when connection is established. Framed MTU attribute is not supported, as it is sent only after authentication with Radius.
User Database

Sub-menu: /ppp secret

PPP User Database stores PPP user access records with PPP user profile assigned to each user.

Properties
caller-id (string; Default: )	For PPTP and L2TP it is the IP address a client must connect from. For PPPoE it is the MAC address (written in CAPITAL letters) a client must connect from. For ISDN it is the caller's number (that may or may not be provided by the operator) the client may dial-in from
comment (string; Default: )	Short description of the user.
disabled (yes | no; Default: no)	Whether secret will be used.
limit-bytes-in (integer; Default: 0)	The maximum amount of bytes for a session that the client can upload.
limit-bytes-out (integer; Default: 0)	The maximum amount of bytes for a session that the client can download.
local-address (IP address; Default: )	IP address that will be set locally on ppp interface.
name (string; Default: )	Name used for authentication
password (string; Default: )	Password used for authentication
profile (string; Default: default)	Which user profile to use
remote-address (IP; Default: )	IP address that will be assigned to the remote ppp interface.
remote-ipv6-prefix (IPv6 prefix; Default: )	IPv6 prefix assigned to ppp client. Prefix is added to ND prefix list enabling stateless address auto-configuration on ppp interface.
routes (string; Default: )	Routes that appear on the server when the client is connected. The route format is: dst-address gateway metric (for example, 10.1.0.0/ 24 10.0.0.1 1). Other syntax is not acceptable since it can be represented incorrectly. Several routes may be specified and separated with commas. This parameter will be ignored for OpenVPN.
service (any | async | isdn | l2tp | pppoe | pptp | ovpn | sstp; Default: any)	Specifies the services that a particular user will be able to use.
Active Users

Sub-menu: /ppp active

This submenu allows monitoring active (connected) users.

/ppp active print command will show all currently connected users.

/ppp active print stats command will show received/sent bytes and packets

Properties
address (IP address)	The IP address the client got from the server
bytes (integer)	Amount of bytes transferred through this connection. The first figure represents the amount of transmitted traffic from the router's point of view, while the second one shows the amount of received traffic.
caller-id (string)	For PPTP and L2TP it is the IP address the client connected from. For PPPoE, it is the MAC address the client connected from.
encoding (string)	Shows encryption and encoding (separated with '/' if asymmetric) being used in this connection
limit-bytes-in (integer)	The maximum amount of bytes the user is allowed to send to the router.
limit-bytes-out (integer)	The maximum amount of bytes the user is allowed to send to the client.
name (string)	User name supplied at authentication stage
packets (integer/integer)	Amount of packets transferred through this connection. The first figure represents the amount of transmitted traffic from the router's point of view, while the second one shows the amount of received traffic
service (async | isdn | l2tp | pppoe | pptp | ovpn | sstp)	Type of service the user is using.
session-id (string)	Shows unique client identifier.
uptime (time)	User's uptime
Remote AAA

Sub-menu: /ppp aaa

Settings in this submenu allows to set RADIUS accounting and authentication. Note that the RADIUS user database is consulted only if the required username is not found in the local user database.

Properties
accounting (yes | no; Default: yes)	Enable RADIUS accounting
interim-update (time; Default: 0s)	Interim-Update time interval
use-radius (yes | no; Default: no)	Enable user authentication via RADIUS. If an entry in the local secret database is not found, then the client will be authenticated via RADIUS.
enable-ipv6-accounting (yes | no; Default: no)	Enable IPv6 separate accounting. PPP service counts Layer2, IPv4 and IPv6 data all together when reporting network usage statistics to the RADIUS server by default. If it is required to differ IPv4 and IPv6 traffic, then this option can be enabled. Prerequisites for it to work are that the prefix must be assigned to the client through PPP service and also rate-limit must be provided. Dynamically created queue statistics will be used as counters for IPv6 data, which then will be included in accounting packets as separate IPv6 statistics attributes. This will not work for prefixes assigned by dynamically created DHCPv6 server due to provided prefix pool or PPP/Profile configuration. Then prefix assignment is handled by DHCP service, not PPP, thus accounting can not be managed by PPP service.
Examples
Add new profile

To add the profile ex that assigns the router itself the 10.0.0.1 address, and the addresses from the ex pool to the clients, filtering traffic coming from clients through mypppclients chain:
[admin@rb13] ppp profile> add name=ex local-address=10.0.0.1 remote-address=ex incoming-filter=mypppclients
[admin@rb13] ppp profile> print
Flags: * - default
 0 * name="default" use-compression=no use-vj-compression=no use-encryption=no only-one=no
     change-tcp-mss=yes
 1   name="ex" local-address=10.0.0.1 remote-address=ex use-compression=default
     use-vj-compression=default use-encryption=default only-one=default change-tcp-mss=default
     incoming-filter=mypppclients
 2 * name="default-encryption" use-compression=default use-vj-compression=default use-encryption=yes
     only-one=default change-tcp-mss=default
[admin@rb13] ppp profile>
Add new user

To add the user ex with password lkjrht and profile ex available for PPTP service only, enter the following command:
[admin@rb13] ppp secret> add name=ex password=lkjrht service=pptp profile=ex
[admin@rb13] ppp secret> print
Flags: X - disabled
 #   NAME                SERVICE CALLER-ID         PASSWORD          PROFILE            REMOTE-ADDRESS
 0   ex                  pptp                      lkjrht            ex                 0.0.0.0
[admin@rb13] ppp secret>




    Creado por Normunds R., actualizado por última vez por Sergejs B. el jun 04, 2025 13 min de lectura

Summary

RADIUS, short for Remote Authentication Dial-In User Service, is a remote server that provides authentication and accounting facilities to various network appliances. RADIUS authentication and accounting allows the ISP or network administrator to manage PPP user access and accounting from one server throughout a large network. The MikroTik RouterOS has a RADIUS client that can authenticate router's local users, HotSpot, PPP, PPPoE, PPTP, L2TP, OVPN, SSTP, IPsec and ISDN connections. The attributes received from the RADIUS server override the ones set in the default profile, but if some parameters are not received they are taken from the respective default profile.

The RADIUS server database is consulted only if no matching user access record is found in the router's local database.

If RADIUS accounting is enabled, accounting information is also sent to the RADIUS server default for that service.
RADIUS Client
Sub-menu: /radius

This sub-menu allows adding and removing RADIUS clients. 

 The order of added items in this list is significant.
Properties
accounting-backup (yes | no; Default: no)	Whether the configuration is for the backup RADIUS server
accounting-port (integer [1..65535]; Default: 1813)	RADIUS server port used for accounting
address (IPv4/IPv6 address; Default: 0.0.0.0)	

IPv4 or IPv6 address of RADIUS server.

The following formats are accepted:

- ipv4
- ipv4@vrf
- ipv6
- ipv6@vrf
authentication-port (integer [1..65535]; Default: 1812)	RADIUS server port used for authentication.
called-id (string; Default: )	Value depends on Point-to-Point protocol: PPPoE - service name, PPTP - server's IP address, L2TP - server's IP address.
certificate (string; Default: )	Certificate file to use for communicating with RADIUS Server with RadSec enabled.
comment (string; Default: )	
disabled (yes | no; Default: no)	
domain (string; Default: )	Microsoft Windows domain of client passed to RADIUS servers that require domain validation.
protocol (radsec | udp; Default: udp)	Specifies the protocol to use when communicating with the RADIUS Server.
require-message-auth (no | yes-for-request-resp Default: yes-for-request-resp)	Specifies if Message-Authenticator attributes are required.
realm (string; Default: )	Explicitly stated realm (user domain), so the users do not have to provide proper ISP domain name in the user name.
secret (string; Default: )	The shared secret used to access the RADIUS server.
service (ppp|login|hotspot|wireless|dhcp|ipsec|dot1x; Default: )	Router services that will use this RADIUS server:

    hotspot - HotSpot authentication service
    login - router's local user authentication
    ppp - Point-to-Point clients authentication
    wireless - wireless client authentication
    dhcp - DHCP protocol client authentication (client's MAC address is sent as User-Name)
    ipsec - ipsec client authentification
    dot1x - dot1x authentification

src-address (ipv4/ipv6 address; Default: 0.0.0.0)	Source IP/IPv6 address of the packets sent to the RADIUS server
timeout (time; Default: 100ms)	Timeout after which the request should be resent, for example, "/radius set timeout=300ms numbers=0"

When the RADIUS server is authenticating the user with CHAP, MS-CHAPv1, MS-CHAPv2, it is not using a shared secret, the secret is used only in the authentication reply, and the router (RADIUS client) verifies it. So if you have the wrong shared secret, the RADIUS server will accept a request, but the router won't accept the reply. You can see that with "/radius monitor" command, the "bad-replies" number should increase whenever somebody tries to connect.

If RadSec is enabled, make sure your RADIUS Server is using "radsec" as the shared secret, otherwise, the RADIUS Server will not be able to decrypt data correctly (unprintable characters). With RadSec RouterOS forces the shared secret to "radsec" regardless of what has been set manually. For more details see - RFC6614.
Example

To set up a RADIUS Client for HotSpot and PPP services that will authenticate against a RADIUS Server (10.0.0.3), you need to do the following:
[admin@MikroTik] > /radius add service=hotspot,ppp address=10.0.0.3 secret=ex
[admin@MikroTik] > /radius print
Flags: X - disabled
# SERVICE CALLED-ID DOMAIN ADDRESS SECRET
0 ppp,hotspot 

To set up a RADIUS Client with RadSec, you need to do the following:
[admin@MikroTik] > /radius add service=hotspot,ppp address=10.0.0.3 secret=radsec protocol=radsec certificate=client.crt
[admin@MikroTik] > /radius print
Flags: X - disabled
# SERVICE CALLED-ID DOMAIN ADDRESS SECRET
0 ppp,hotspot 10.0.0.3 radsec

Make sure the specified certificate is trusted. 

To view RADIUS Client statistics, you need to do the following:
[admin@MikroTik] > /radius monitor 0
pending: 0
requests: 10
accepts: 4
rejects: 1
resends: 15
timeouts: 5
bad-replies: 0
last-request-rtt: 0s

Make sure you enable RADIUS authentication for the desired services:
/ppp aaa set use-radius=yes
/ip hotspot profile set default use-radius=yes
Connection Terminating from RADIUS

Sub-menu: /radius incoming

This facility supports unsolicited messages sent from the RADIUS server. Unsolicited messages extend RADIUS protocol commands, that allow terminating a session that has already been connected from the RADIUS server. For this purpose, DM (Disconnect-Messages) is used. Disconnect messages cause a user session to be terminated immediately. 

RouterOS doesn't support POD (Packet of Disconnect) the other RADIUS access request packet that performs a similar function as Disconnect Messages
Properties
accept (yes | no; Default: no)	Whether to accept unsolicited messages
port (integer; Default: 1700)	The port number to listen for the requests on

vrf (VRF name; default value: main)
	Set VRF on which service is listening for incoming connections
Supported RADIUS Attributes

Here you can download the RADIUS reference dictionary, that includes all supported RADIUS attributes by MikroTik device. This file is designed for FreeRADIUS, but may also be used by other RADIUS servers. Note, it may conflict with the default configuration file of your RADIUS server, correct the configuration, not the dictionary, as no other attributes are supported by MikroTik RouterOS. There is also the RADIUS MikroTik specific dictionary that can be included in an existing dictionary to support MikroTik vendor-specific attributes.

Below you will find description about attributes and how they are used on MikroTik devices during communication with RADIUS.
Definitions

    PPPs - PPP,PPTP, PPPoE
    default configuration -settings in default profile (for PPPs) or HotSpot server settings (for HotSpot)

Access-Request packet

    Service-Type - always is "Framed" (only for PPPs)
    Framed-Protocol - always is "PPP" (only for PPPs)
    NAS-Identifier - router's identity name
    NAS-IP-Address - IP address of the router itself
    NAS-Port - this Attribute indicates the physical port number of the NAS which is authenticating the user.
    Acct-Session-Id - unique session ID. The first two symbols of session ID represent service (PPP, Hotspot, etc.). The next symbol is incremented on each reboot. The last group of symbols is incremented on each new session. This means, that you can not get the same ID for 1 million re-connects on the same boot for the same RADIUS type service. If you lose session stop message and RADIUS server does still keep the session open, but then receives another session start message, then it must be aware that stop message was lost, close old session and start a new session.
    NAS-Port-Type - async PPP - "Async"; PPTP and L2TP - "Virtual"; PPPoE - "Ethernet"; ISDN - "ISDN Sync"; HotSpot - "Ethernet | Cable | Wireless-802.11" (according to the value of nas-port-type parameter in /ip hotspot profile)
    Calling-Station-Id - PPPoE and HotSpot- client MAC address in capital letters; PPTP and L2TP - client public IP address
    Called-Station-Id - PPPoE - service name; PPTP and L2TP - server IP address; HotSpot - name of the HotSpot server
    NAS-Port-Id - async PPP - serial port name; PPPoE - ethernet interface name on which server is running; HotSpot - name of the physical HotSpot interface (if bridged, the bridge port name is showed here); not present for ISDN, PPTP and L2TP
    Framed-IP-Address - IP address of HotSpot client after Universal Client translation
    Mikrotik-Host-IP - IP address of HotSpot client before Universal Client translation (the original IP address of the client)
    User-Name - client login name
    MS-CHAP-Domain - User domain, if present
    Mikrotik-Realm - If it is set in /radius menu, it is included in every RADIUS request as Mikrotik-Realm attribute. If it is not set, the same value is sent as in MS-CHAP-Domain attribute (if MS-CHAP-Domain is missing, Realm is not included neither)
    WISPr-Location-ID - text string specified in radius-location-id property of the HotSpot server
    WISPr-Location-Name - text string specified in radius-location-name property of the HotSpot server
    WISPr-Logoff-URL - full link to the login page (for example, http://10.48.0.1/lv/logout)

Depending on authentication methods (NOTE: HotSpot uses CHAP by default and may use also PAP if unencrypted passwords are enabled, it can not use MSCHAP).

    User-Password - encrypted password (used with PAP authentication)
    CHAP-Password, CHAP-Challenge - encrypted password and challenge (used with CHAP authentication)
    MS-CHAP-Response, MS-CHAP-Challenge - encrypted password and challenge (used with MS-CHAPv1 authentication)
    MS-CHAP2-Response, MS-CHAP-Challenge - encrypted password and challenge (used with MS-CHAPv2 authentication)

Access-Accepts packet

    Framed-IP-Address - IP address given to client. If address belongs to 127.0.0.0/8 or 224.0.0.0/3 networks, IP pool is used from the default profile to allocate client IP address. If Framed-IP-Address is specified, Framed-Pool is ignored
    Framed-IP-Netmask - client netmask. PPPs - if specified, a route will be created to the network Framed-IP-Address belongs to via the Framed-IP-Address gateway; HotSpot - ignored by HotSpot
    Framed-Pool - IP pool name (on the router) from which to get IP address for the client. If Framed-IP-Address is specified, this attribute is ignored
    Framed-IPv6-Prefix - IPv6 prefix assigned for the client
    Mikrotik-Delegated-IPv6-Pool - IPv6 pool used for Prefix Delegation
    Delegated-IPv6-Prefix - IPv6 Prefix
    Delegated-IPv6-Prefix-Pool - IPv6 Prefix pool used for Prefix Delegation

NOTE: if Framed-IP-Address or Framed-Pool is specified it overrides remote-address in default configuration.

    Idle-Timeout - overrides idle-timeout in the default configuration
    Session-Timeout - overrides session-timeout in the default configuration
    Port-Limit - maximal mumber of simultaneous connections using the same username (overrides te shared-users property of the HotSpot user profile)
    Class - cookie, will be included in Accounting-Request unchanged
    Framed-Route - routes to add on the server. Format is specified in RFC 2865 (Ch. 5.22), can be specified as many times as needed
    Filter-Id - firewall filter chain name. It is used to make a dynamic firewall rule. Firewall chain name can have suffix .in or .out, that will install rule only for incoming or outgoing traffic. Multiple Filter-id can be provided, but only last ones for incoming and outgoing is used. For PPPs - filter rules in ppp chain that will jump to the specified chain, if a packet has come to/from the client (that means that you should first create a ppp chain and make jump rules that would put actual traffic to this chain). The same applies for HotSpot, but the rules will be created in hotspot chain
    Mikrotik-Mark-Id - firewall mangle chain name (HotSpot only). The MikroTik RADIUS client upon receiving this attribute creates a dynamic firewall mangle rule with action=jump chain=hotspot and jump-target equal to the atribute value. Mangle chain name can have suffixes .in or .out, that will install rule only for incoming or outgoing traffic. Multiple Mark-id attributes can be provided, but only last ones for incoming and outgoing is used.
    Acct-Interim-Interval - interim-update for RADIUS client. PPP - if 0 uses the one specified in RADIUS client; HotSpot - only respected if radius-interim-update=received in HotSpot server profile
    MS-MPPE-Encryption-Policy - require-encryption property (PPPs only)
    MS-MPPE-Encryption-Types - use-encryption property, non-zero value means to use encryption (PPPs only)
    Ascend-Data-Rate - tx/rx data rate limitation if multiple attributes are provided, first limits tx data rate, second - rx data rate. If used together with Ascend-Xmit-Rate, specifies rx rate. 0 if unlimited. Ignored if Rate-Limit attribute is present
    Ascend-Xmit-Rate - tx data rate limitation. It may be used to specify tx limit only instead of sending two sequental Ascend-Data-Rate attributes (in that case Ascend-Data-Rate will specify the receive rate). 0 if unlimited. Ignored if Rate-Limit attribute is present
    MS-CHAP2-Success - auth. response if MS-CHAPv2 was used (for PPPs only)
    MS-MPPE-Send-Key, MS-MPPE-Recv-Key - encryption keys for encrypted PPPs provided by RADIUS server only is MS-CHAPv2 was used as authentication (for PPPs only)
    Ascend-Client-Gateway - client gateway for DHCP-pool HotSpot login method (HotSpot only)
    Mikrotik-Recv-Limit - total receive limit in bytes for the client
    Mikrotik-Recv-Limit-Gigawords - 4G (2^32) bytes of total receive limit (bits 32..63, when bits 0..31 are delivered in Mikrotik-Recv-Limit)
    Mikrotik-Xmit-Limit - total transmit limit in bytes for the client
    Mikrotik-Xmit-Limit-Gigawords - 4G (2^32) bytes of total transmit limit (bits 32..63, when bits 0..31 are delivered in Mikrotik-Recv-Limit)
    Mikrotik-Wireless-Forward - not forward the client's frames back to the wireless infrastructure if this attribute is set to "0" (Wireless only)
    Mikrotik-Wireless-Skip-Dot1x - disable 802.1x authentication for the particulat wireless client if set to non-zero value (Wireless only)
    Mikrotik-Wireless-Enc-Algo - WEP encryption algorithm: 0 - no encryption, 1 - 40-bit WEP, 2 - 104-bit WEP (Wireless only)
    Mikrotik-Wireless-Enc-Key - WEP encruption key for the client (Wireless only)
    Mikrotik-Wireless-VLANID - VLAN ID for the client (Wireless only)
    Mikrotik-Wireless-VLANID-type - VLAN ID type for the client. 0 - 802.1q tag and 1 - 802.1ad tag (Wireless only)
    Mikrotik-Switching-Filter - allows to create dynamic switch rules, when authenticating clients with dot1x server.
    Mikrotik-Rate-Limit - Datarate limitation for clients. Format is: rx-rate[/tx-rate] [rx-burst-rate[/tx-burst-rate] [rx-burst-threshold[/tx-burst-threshold] [rx-burst-time[/tx-burst-time] [priority] [rx-rate-min[/tx-rate-min]]]] from the point of view of the router (so "rx" is client upload, and "tx" is client download). All rates should be numbers with optional 'k' (1,000s) or 'M' (1,000,000s). If tx-rate is not specified, rx-rate is as tx-rate too. Same goes for tx-burst-rate and tx-burst-threshold and tx-burst-time. If both rx-burst-threshold and tx-burst-threshold are not specified (but burst-rate is specified), rx-rate and tx-rate is used as burst thresholds. If both rx-burst-time and tx-burst-time are not specified, 1s is used as default. Priority takes values 1..8, where 1 implies the highest priority, but 8 - the lowest. If rx-rate-min and tx-rate-min are not specified rx-rate and tx-rate values are used. The rx-rate-min and tx-rate-min values can not exceed rx-rate and tx-rate values.
    Mikrotik-Group - Router local user group name (defines in /user group) for local users; HotSpot default profile for HotSpot users; PPP default profile name for PPP users.
    Mikrotik-Advertise-URL - URL of the page with advertisements that should be displayed to clients. If this attribute is specified, advertisements are enabled automatically, including transparent proxy, even if they were explicitly disabled in the corresponding user profile. Multiple attribute instances may be send by RADIUS server to specify additional URLs which are choosen in round robin fashion.
    Mikrotik-Advertise-Interval - Time interval between two adjacent advertisements. Multiple attribute instances may be send by RADIUS server to specify additional intervals. All interval values are treated as a list and are taken one-by-one for each successful advertisement. If end of list is reached, the last value is continued to be used.
    WISPr-Redirection-URL - URL, which the clients will be redirected to after successfull login
    WISPr-Bandwidth-Min-Up - minimal datarate (CIR) provided for the client upload
    WISPr-Bandwidth-Min-Down - minimal datarate (CIR) provided for the client download
    WISPr-Bandwidth-Max-Up - maxmal datarate (MIR) provided for the client upload
    WISPr-Bandwidth-Max-Down - maxmal datarate (MIR) provided for the client download
    WISPr-Session-Terminate-Time - time, when the user should be disconnected; in "YYYY-MM-DDThh:mm:ssTZD" form, where Y - year; M - month; D - day; T - separator symbol (must be written between date and time); h - hour (in 24 hour format); m - minute; s - second; TZD - time zone in one of these forms: "+hh:mm", "+hhmm", "-hh:mm", "-hhmm".

The received attributes override the default ones (set in the default profile), but if an attribute is not received from RADIUS server, the default one is to be used.  Rate-Limit takes precedence over all other ways to specify data rate for the client. Ascend data rate attributes are considered second; and WISPr attributes takes the last precedence.

Here are some Rate-Limit examples:

    128k - rx-rate=128000, tx-rate=128000 (no bursts)
    64k/128M - rx-rate=64000, tx-rate=128000000
    64k 256k - rx/tx-rate=64000, rx/tx-burst-rate=256000, rx/tx-burst-threshold=64000, rx/tx-burst-time=1s
    64k/64k 256k/256k 128k/128k 10/10 - rx/tx-rate=64000, rx/tx-burst-rate=256000, rx/tx-burst-threshold=128000, rx/tx-burst-time=10s

Accounting-Request packet

The accounting request carries the same attributes as Access Request, plus these ones:

    Acct-Status-Type - Start, Stop, or Interim-Update
    Acct-Authentic - either authenticated by the RADIUS or Local authority (PPPs only)
    Class - RADIUS server cookie, as received in Access-Accept
    Acct-Delay-Time - how long does the router try to send this Accounting-Request packet

Stop and Interim-Update Accounting-Request packet

Additionally to the accounting start request, the following messages will contain the following attributes:

    Acct-Session-Time - connection uptime in seconds
    Acct-Input-Octets - bytes received from the client
    Acct-Input-Gigawords - 4G (2^32) bytes received from the client (bits 32..63, when bits 0..31 are delivered in Acct-Input-Octets)
    Acct-Input-Packets - nubmer of packets received from the client
    Acct-Output-Octets - bytes sent to the client
    Acct-Output-Gigawords - 4G (2^32) bytes sent to the client (bits 32..63, when bits 0..31 are delivered in Acct-Output-Octets)
    Acct-Output-Packets - number of packets sent to the client

Stop Accounting-Request packet

These packets will, additionally to the Interim Update packets, have:

    Acct-Terminate-Cause - session termination cause (see RFC 2866 ch. 5.10)

Change of Authorization

RADIUS disconnect and Change of Authorization (according to RFC3576) are supported as well. These attributes may be changed by a CoA request from the RADIUS server:

    Mikrotik-Group
    Mikrotik-Recv-Limit
    Mikrotik-Xmit-Limit
    Mikrotik-Rate-Limit
    Ascend-Data-Rate (only if Mikrotik-Rate-Limit is not present)
    Ascend-XMit-Rate (only if Mikrotik-Rate-Limit is not present)
    Mikrotik-Mark-Id
    Filter-Id
    Mikrotik-Advertise-Url
    Mikrotik-Advertise-Interval
    Session-Timeout
    Idle-Timeout
    Port-Limit

Note that it is not possible to change IP address, pool or routes that way - for such changes a user must be disconnected first.
MikroTik Specific RADIUS Attribute Numeric Values
MIKROTIK_RECV_LIMIT	14988	1	
MIKROTIK_XMIT_LIMIT	14988	2	
MIKROTIK_GROUP	14988	3	
MIKROTIK_WIRELESS_FORWARD	14988	4	
MIKROTIK_WIRELESS_SKIPDOT1X	14988	5	
MIKROTIK_WIRELESS_ENCALGO	14988	6	
MIKROTIK_WIRELESS_ENCKEY	14988	7	
MIKROTIK_RATE_LIMIT	14988	8	
MIKROTIK_REALM	14988	9	
MIKROTIK_HOST_IP	14988	10	
MIKROTIK_MARK_ID	14988	11	
MIKROTIK_ADVERTISE_URL	14988	12	
MIKROTIK_ADVERTISE_INTERVAL	14988	13	
MIKROTIK_RECV_LIMIT_GIGAWORDS	14988	14	
MIKROTIK_XMIT_LIMIT_GIGAWORDS	14988	15	
MIKROTIK_WIRELESS_PSK	14988	16	
MIKROTIK_TOTAL_LIMIT	14988	17	
MIKROTIK_TOTAL_LIMIT_GIGAWORDS	14988	18	
MIKROTIK_ADDRESS_LIST	14988	19	
MIKROTIK_WIRELESS_MPKEY	14988	20	
MIKROTIK_WIRELESS_COMMENT	14988	21	
MIKROTIK_DELEGATED_IPV6_POOL	14988	22	
MIKROTIK_DHCP_OPTION_SET	14988	23	
MIKROTIK_DHCP_OPTION_PARAM_STR1	14988	24	
MIKROTIK_DHCP_OPTION_PARAM_STR2	14988	25	
MIKROTIK_WIRELESS_VLANID	14988	26	
MIKROTIK_WIRELESS_VLANIDTYPE	14988	27	
MIKROTIK_WIRELESS_MINSIGNAL	14988	28	
MIKROTIK_WIRELESS_MAXSIGNAL	14988	29	
All Supported Attribute Numeric Values
Acct-Authentic	
	45	RFC 2866
Acct-Delay-Time	
	41	RFC 2866
Acct-Input-Gigawords	
	52	RFC 2869
Acct-Input-Octets	
	42	RFC 2866
Acct-Input-Packets	
	47	RFC 2866
Acct-Interim-Interval	
	85	RFC 2869
Acct-Output-Gigawords	
	53	RFC 2869
Acct-Output-Octets	
	43	RFC 2866
Acct-Output-Packets	
	48	RFC 2866
Acct-Session-Id	
	44	RFC 2866
Acct-Session-Time	
	46	RFC 2866
Acct-Status-Type	
	40	RFC 2866
Acct-Terminate-Cause	
	49	RFC 2866
Ascend-Client-Gateway	529	132	
Ascend-Data-Rate	529	197	
Ascend-Xmit-Rate	529	255	
Called-Station-Id	
	30	RFC 2865
Calling-Station-Id	
	31	RFC 2865
CHAP-Challenge	
	60	RFC 2866
CHAP-Password	
	3	RFC 2865
Class	
	25	RFC 2865
Filter-Id	
	11	RFC 2865
Framed-Compression	
	53	RFC 2865
Framed-IP-Address	
	8	RFC 2865
Framed-IP-Netmask	
	9	RFC 2865
Framed-IPv6-Prefix	
	97	RFC 3162
Framed-Mtu	
	52	RFC 2869
Framed-Pool	
	88	RFC 2869
Framed-Protocol	
	7	RFC 2865
Framed-Route	
	22	RFC 2865
Framed-Routing	
	50	RFC 2865
Idle-Timeout	
	28	RFC 2865
MS-CHAP-Challenge	311	11	RFC 2548
MS-CHAP-Domain	311	10	RFC 2548
MS-CHAP-Response	311	1	RFC 2548
MS-CHAP2-Response	311	25	RFC 2548
MS-CHAP2-Success	311	26	RFC 2548
MS-MPPE-Encryption-Policy	311	7	RFC 2548
MS-MPPE-Encryption-Types	311	8	RFC 2548
MS-MPPE-Recv-Key	311	17	RFC 2548
MS-MPPE-Send-Key	311	16	RFC 2548
NAS-Identifier	
	32	RFC 2865
NAS-Port	
	5	RFC 2865
NAS-IP-Address	
	4	RFC 2865
NAS-Port-Id	
	87	RFC 2869
NAS-Port-Type	
	61	RFC 2865
Port-Limit	
	62	RFC 2865
Redback-Agent-Remote-Id	2352	96	
Redback-Agent-Circuit-Id	2352	97	
Service-Type	
	6	RFC 2865
Session-Timeout	
	27	RFC 2865
User-Name	
	1	RFC 2865
User-Password	
	2	RFC 2865
WISPr-Bandwidth-Max-Down	14122	8	wi-fi.org
WISPr-Bandwidth-Max-Up	14122	7	wi-fi.org
WISPr-Bandwidth-Min-Down	14122	6	wi-fi.org
WISPr-Bandwidth-Min-Up	14122	5	wi-fi.org
WISPr-Location-Id	14122	1	wi-fi.org
WISPr-Location-Name	14122	2	wi-fi.org
WISPr-Logoff-URL	14122	3	wi-fi.org
WISPr-Redirection-URL	14122	4	wi-fi.org
WISPr-Session-Terminate-Time	14122	9	wi-fi.org
WISPr-Session-Terminate-End-Of-Day	14122	10	wi-fi.org
WISPr-Billing-Class-Of-Service	14122	11	wi-fi.org




    Creado por Māris B., actualizado por última vez por Matīss O. el mar 27, 2025 6 min de lectura

    Summary
    User Settings
    User Groups
        Properties
        Default groups
    Router Users
        Properties
        Actions
        Notes
    Monitoring Active Users
        Properties
        Request logout
    Remote AAA
        Properties
    SSH Keys 
        Public keys
            Import public SSH key
            Add public SSH key
        Private keys
            Import private SSH key

Summary

MikroTik RouterOS router user facility manages the users connecting the router from any of the Management tools. The users are authenticated using either a local database or a designated RADIUS server. Each user is assigned to a user group, which denotes the rights of this user. A group policy is a combination of individual policy items.

In case the user authentication is performed using RADIUS, the RADIUS client should be previously configured.
User Settings

The settings submenu allows to control the password complexity requirements of the router users. 
minimum-password-length (integer; 0..4294967295; Default: )	Specifies the minimum character length of the user password
minimum-categories (integer; 0..4; Default: )	

Specifies the complexity requirements of the password, with categories being uppercase, lowercase, digit, symbol. 


User Groups

The router user groups provide a convenient way to assign different permissions and access rights to different user classes. 
Properties
name (string; Default: )	The name of the user group
policy (local | telnet | ssh | ftp | reboot | read | write | policy | test | winbox | password | web | sniff | sensitive | api | rest-api | romon ; Default: none)	List of allowed policies:


Login policies:

    local - policy that grants rights to log in locally via console
    telnet - policy that grants rights to log in remotely via telnet
    ssh - policy that grants rights to log in remotely via secure shell protocol
    web - policy that grants rights to log in remotely via WebFig.
    winbox - policy that grants rights to log in remotely via WinBox and bandwidth test authentication
    password - policy that grants rights to change the password
    api - grants rights to access router via API.
    rest-api - grants rights to access the router via REST API.
    ftp - policy that grants full rights to log in remotely via FTP.  Allows to read/write/erase files and to transfer files from/to the router. Should be used together with read/write policies.
    romon - policy that grants rights to connect to the RoMon server.

Config Policies:

    reboot - policy that allows rebooting the router
    read - policy that grants read access to the router's configuration. All console commands that do not alter the router's configuration are allowed. Doesn't affect FTP
    write - policy that grants write access to the router's configuration, except for user management. This policy does not allow to read the configuration, so make sure to enable read policy as well
    policy - policy that grants user management rights. Should be used together with the write policy. Allows also to see global variables created by other users (requires also 'test' policy). Allows to design skins (requires also "sensitive" policy).
    test - policy that grants rights to run ping, traceroute, bandwidth-test, wireless scan, snooper, fetch, email and other test commands
    sensitive - grants rights to change "hide sensitive" option, if this policy is disabled sensitive information is not displayed.
    sniff - policy that grants rights to use packet sniffer tool, torch tool, traffic generator.

skin (name; Default: default)	Used skin for WebFig
Default groups

There are three default system groups which cannot be deleted:
[admin@MikroTik] > /user group print 
0 name="read" policy=local,telnet,ssh,reboot,read,test,winbox,password,web,sniff,sensitive,api,romon,rest-api,!ftp,!write,!policy skin=default 

1 name="write" policy=local,telnet,ssh,reboot,read,write,test,winbox,password,web,sniff,sensitive,api,romon,rest-api,!ftp,!policy skin=default 

2 name="full" policy=local,telnet,ssh,ftp,reboot,read,write,policy,test,winbox,password,web,sniff,sensitive,api,romon,rest-api skin=default 

Please note, that even the "read" group includes sensitive, reboot, and other important policies, meaning that this group should not be given to untrusted users. For truly limited groups, make a custom group, defining specific policies. All groups have access to file operations. Exclamation sign '!' just before the policy item name means NOT.
Router Users

The router user database stores information such as username, password, allowed access addresses, and group about router management personnel. 
Properties
address (IP/mask | IPv6 prefix; Default: )	Host or network address from which the user is allowed to log in
group (string; Default: )	Name of the group the user belongs to
inactivity-policy (lockscreen | logout | none; Default: none)	Specifies inactivity action - logout (user will be logged out) or lockscreen (session will be locked, require password input to continue). Works only for CLI sessions.
inactivity-timeout (time; Default: 10min)	Specifies time after which user will be logged out or session will be locked. Minimal timeout - 1 minute, maximal timeout - 24 hours. Works only for CLI sessions.
name (string; Default: )	User name. Must start and end with an alphanumeric character but can include "_", ".", "#", "-", and "@" symbols. However the "*" symbol is prohibited in the user name.
password (string; Default: )	User password. If not specified, it is left blank (hit [Enter] when logging in). It conforms to standard Unix characteristics of passwords and may contain letters, digits, "*" and "_" symbols.
last-logged-in (time and date; Default: "")	Read-only field. Last time and date when a user logged in.
Actions

Actions for existing router user.
password	Option to change user password.
expire-password	Expires user password, on next login, router will prompt to change password.
Notes

There is one predefined user with full access rights:
[admin@MikroTik] user> print
Flags: X - disabled
# NAME GROUP ADDRESS LAST-LOGGED-IN
0 ;;; system default user
admin full 0.0.0.0/0 dec/08/2010 16:19:24

There always should be at least one user with full access rights. If the user with full access rights is the only one, it cannot be removed.
Monitoring Active Users
/user active print

 The command shows the currently active users along with respective statistics information.
Properties

All properties are read-only.
address (IP/IPv6 address/MAC address)	Host IP/IPv6/MAC address from which the user is accessing the router.
group (string)	A group that the user belongs to.
name (string)	Username.
radius (true | false)	Whether a user is authenticated by the RADIUS server.
via (telnet | ssh | winbox | api | rest-api | web | ftp )	User's access method
by-romon (MAC address)	RoMON agent MAC address
when (time)	Time and date when the user logged in.
Request logout

It is possible to close an active CLI session using the request logout function.


 /user/active/request-logout ACTIVE_USER_SESSION_NUMBER


Remote AAA

Router user remote AAA enables router user authentication and accounting via a RADIUS server. The RADIUS user database is consulted only if the required username is not found in the local user database.
Properties
accounting (yes | no; Default: yes)	If the RADIUS server should be sent accounting of login, logout. Bandwidth usage statistics are not part of /user accounting
exclude-groups (list of group names; Default: )	Exclude-groups consist of the groups that should not be allowed to be used for users authenticated by radius. If the radius server provides a group specified in this list, the default-group will be used instead.


This is to protect against privilege escalation when one user (without policy permission) can change the radius server list, set up its own radius server and
log in as admin.
default-group (string; Default: read)	User group used by default for users authenticated via a RADIUS server.
interim-update (time; Default: 0s)	Interim-Update time interval
use-radius (yes |no; Default: no)	Enable user authentication via RADIUS

If you are using RADIUS, you need to have CHAP support enabled in the RADIUS server for WinBox to work
SSH Keys 

 This menu allows importing of private and public keys used for SSH authentication. 

By default, User is not allowed to log in via SSH by password if an SSH key for the user is added. For more details see the SSH page.
Public keys

This menu is used to import (or add) and list imported public keys. Public keys are used to approve another device's identity when logging into a router using an SSH key.

RSA and Ed25519 keys are supported in PEM, PKCS#8, or OpenSSH format.
user (string; Default: )	system user to which the SSH key has been assigned
key-owner (string)	SSH key owner
key-type (read-only)	key type
bits (read-only)	key length
Import public SSH key

On public SSH key import, must specify key file, system user to which SSH key will been assigned, optional it is possible to specify key owner.
user (string; Default: )	system user to which the SSH key has been assigned
key-owner (string)	SSH key owner
public-key-file (string)	file name in the router's root directory containing public key
Add public SSH key

It is possible to add public SSH key (pasting SSH key string), must provide key string, system user to which the SSH key has been assigned. 

It is possible to add keys only in OpenSSH format


user (string; Default: )	system user to which SSH key has been assigned
key (string)	public key 


Private keys

This menu is used to import and list imported private keys. Private keys are used to approve the router's identity during login into another device using an SSH key.

On private key import, is it possible to specify key-owner.

RSA and Ed25519 keys are supported in PEM or PKCS#8 format.
user (string; Default: )	system user to which the SSH key has been assigned
key-owner (string)	SSH key owner
key-type (read-only)	key type
bits (read-only)	key length
Import private SSH key

On private SSH key import, must specify key file, system user to which SSH key will been assigned, optional it is possible to provide key passhrase and specify key owner.
user (string; Default: )	system user to which the SSH key has been assigned
key-owner (string)	SSH key owner
passphrase (string)	key file passphrase
private-key-file (string)	file name in the router's root directory containing private key




    Creado por Usuario desconocido (emils), actualizado por última vez por Ruslans Sudņiks el ene 27, 2025 19 min de lectura

    Overview
    Attributes
    Database
    Limitations
    Payments
    Profiles
    Profile Limitations
    Routers
    Sessions
    Settings
        Advanced
    Users
    User Groups
    User Profiles
    WEB Interface
    Application Guides
        Batch user creation
        Providing NAS with custom RADIUS attributes
            Static IP address for a user
            Specifying address pool for a group of users
        Using TOTP (time-based one-time password) for user authentication
        Exporting user credentials
            Printable login credentials for a single user
            Multiple user credential export
        Generating usage report
        Purchasing a profile
        Migrating from RouterOS v6
    Application Examples
        Basic L2TP/IPsec server with User Manager authentication
        MFA authentication for RouterOS user login

Overview

User Manager is RADIUS server implementation in RouterOS which provides centralized user authentication and authorization to a certain service. Having a central user database allows better tracking of system users and customers. As a separate package, User Manager is available on all architectures except SMIPS, however, care must be taken due to limited free space available. It supports many different authentication methods including PAP, CHAP, MS-CHAP, MS-CHAPv2, EAP-TLS, EAP-TTLS, and EAP-PEAP. In RouterOS, DHCP, Dot1x, Hotspot, IPsec, PPP, and Wireless are features that benefit from User Manager the most. Each user can see their account statistics and manage available profiles using the WEB interface. Additionally, users can buy their own data plans (profiles) using the most popular payment gateway - PayPal making it a great system for service providers. Customized reports can be generated to ease processing by the billing department. User Manager works according to RADIUS standards defined in RFC2865 and RFC3579.

User Manager is one of the RouterOS features, that is limited by the RouterOS license level. Depending on the License level, number of active sessions will be limited, including multiple connections per user (not unique accounts).

Attributes

Sub-menu: /user-manager attribute

RADIUS attributes are defined authorization, information, and configuration parameters that are passed between the RADIUS server and the client. User Manager allows sending customized attributes defined in the "attributes" menu. RouterOS has a set of predefined attributes already present, but it is also possible to add additional attributes if necessary. Predefined attributes:

Framed-IP-Address
	0 (standard)	8	ip address	Access-Accept	RFC2865 section 5.8

Framed-IP-Netmask
	0 (standard)	9	ip address	Access-Accept	RFC2865 section 5.9

Session-Timeout
	0 (standard)	27	integer (maximum value: 21474720)	Access-Accept, Access-Challenge	RFC2865 section 5.27

Idle-Timeout
	0 (standard)	28	integer	Access-Accept, Access-Challenge	RFC2865 section 5.28

Tunnel-Type
	0 (standard)	64	
1	Point-to-Point Tunneling Protocol (PPTP)
2	Layer Two Forwarding (L2F)
3	Layer Two Tunneling Protocol (L2TP)
4	Ascend Tunnel Management Protocol (ATMP)
5	Virtual Tunneling Protocol (VTP)
6	IP Authentication Header in the Tunnel-mode (AH)
7	IP-in-IP Encapsulation (IP-IP)
8	Minimal IP-in-IP Encapsulation (MIN-IP-IP)
9	IP Encapsulating Security Payload in the Tunnel-mode (ESP)
10	Generic Route Encapsulation (GRE)
11	Bay Dial Virtual Services (DVS)
12	IP-in-IP Tunneling
13	Virtual LAN
	Access-Accept	

RFC2868 section 3.1
RFC3580 section 3.31

Tunnel-Medium-Type
	0 (standard)	65	
1	IPv4 (IP version 4)
2	IPv6 (IP version 6)
3	NSAP
4	HDLC (8-bit multidrop)
5	BBN 1822
6	802 (includes all 802 media plus Ethernet "canonical format")
7	E.163 (POTS)
8	E.164 (SMDS, Frame Relay, ATM)
9	F.69 (Telex)
10	X.121 (X.25, Frame Relay)
11	IPX
12	Appletalk
13	Decnet IV
14	Banyan Vines
15	E.164 with NSAP format subaddress
	Access-Accept	RFC2868 section 3.2

Tunnel-Private-Group-ID
	0 (standard)	81	string	Access-Accept	RFC2868 section 3.6

Framed-Pool
	0 (standard)	88	string	Access-Accept	RFC2869 section 5.18
Framed-IPv6-Prefix	0 (standard)	97	ipv6 prefix	Access-Accept	RFC3162 section 2.3

Framed-IPv6-Pool
	0 (standard)	100	string	Access-Accept	RFC3162 section 2.6

Delegated-IPv6-Prefix
	0 (standard)	123	ipv6 prefix	Access-Accept	RFC4818
Framed-IPv6-Address	0 (standard)	168	ip address	Access-Accept	RFC6911 section 3.1
Mikrotik-Recv-Limit	14988 (Mikrotik)	1	integer	Access-Accept	Total receive limit in bytes for the client.
Mikrotik-Xmit-Limit	14988 (Mikrotik)	2	integer	Access-Accept	Total transmit limit in bytes for the client.
Mikrotik-Group	14988 (Mikrotik)	3	string	Access-Accept	

User's group for local users.

HotSpot profile for HotSpot users.

PPP profile for PPP users.
Mikrotik-Wireless-Forward	14988 (Mikrotik)	4	integer	Access-Accept	Not forward the client's frames back to the wireless infrastructure if this attribute is set to "0" (wireless only).
Mikrotik-Wireless-Skip-Dot1x	14988 (Mikrotik)	5	integer	Access-Accept	Disable 802.1x authentication for the particular wireless client if set to a non-zero value (wireless only).
Mikrotik-Wireless-Enc-Algo	14988 (Mikrotik)	6	
0	No-encryption
1	40-bit-WEP
2	104-bit-WEP
3	AES-CCM
4	TKIP
	Access-Accept	WEP encryption algorithm( wireless only).
Mikrotik-Wireless-Enc-Key	14988 (Mikrotik)	7	string	Access-Accept	WEP encryption key for the client (wireless only).
Mikrotik-Rate-Limit	14988 (Mikrotik)	8	string	Access-Accept	Datarate limitation for clients. The format is: rx-rate[/tx-rate] [rx-burst-rate[/tx-burst-rate] [rx-burst-threshold[/tx-burst-threshold] [rx-burst-time[/tx-burst-time] [priority] [rx-rate-min[/tx-rate-min]]]] from the point of view of the router (so "rx" is client upload, and "tx" is client download). All rates should be numbers with optional 'k' (1,000s) or 'M' (1,000,000s). If the tx-rate is not specified, the rx-rate is as tx-rate too. The same goes for tx-burst-rate and tx-burst-threshold and tx-burst-time. If both rx-burst-threshold and tx-burst-threshold are not specified (but burst-rate is specified), rx-rate and tx-rate are used as burst thresholds. If both rx-burst-time and tx-burst-time are not specified, 1s is used as default. Priority takes values 1..8, where 1 implies the highest priority, but 8 - the lowest. If rx-rate-min and tx-rate-min are not specified rx-rate and tx-rate values are used. The rx-rate-min and tx-rate-min values can not exceed rx-rate and tx-rate values. 
Mikrotik-Realm	14988 (Mikrotik)	9	string	Access-Request	If it is set in /radius menu, it is included in every RADIUS request as Mikrotik-Realm attribute. If it is not set, the same value is sent as in the MS-CHAP-Domain attribute (if MS-CHAP-Domain is missing, Realm is not included either).
Mikrotik-Host-IP	14988 (Mikrotik)	10	ip address	Access-Request	The IP address of HotSpot client before Universal Client translation (the original IP address of the client).
Mikrotik-Mark-Id	14988 (Mikrotik)	11	string	Access-Accept	Firewall mangle chain name (HotSpot only). The MikroTik RADIUS client upon receiving this attribute creates a dynamic firewall mangle rule with action=jump chain=hotspot and jump-target equal to the attribute value. Mangle chain name can have suffixes .in or .out, which will install rule only for incoming or outgoing traffic. Multiple Mark-id attributes can be provided, but only the last ones for incoming and outgoing are used. 
Mikrotik-Advertise-URL	14988 (Mikrotik)	12	string	Access-Accept	URL of the page with advertisements that should be displayed to clients. If this attribute is specified, advertisements are enabled automatically, including transparent proxy, even if they were explicitly disabled in the corresponding user profile. Multiple attribute instances may be sent by the RADIUS server to specify additional URLs which are chosen in a round-robin fashion.
Mikrotik-Advertise-Interval	14988 (Mikrotik)	13	integer	Access-Accept	The time interval between two adjacent advertisements. Multiple attribute instances may be sent by the RADIUS server to specify additional intervals. All interval values are treated as a list and are taken one by one for each successful advertisement. If the end of the list is reached, the last value is continued to be used.
Mikrotik-Recv-Limit-Gigawords	14988 (Mikrotik)	14	integer	Access-Accept	4G (2^32) bytes of total receive limit (bits 32..63, when bits 0..31 are delivered in Mikrotik-Recv-Limit).
Mikrotik-Xmit-Limit-Gigawords	14988 (Mikrotik)	15	integer	Access-Accept	4G (2^32) bytes of total transmit limit (bits 32..63, when bits 0..31 are delivered in Mikrotik-Recv-Limit).
Mikrotik-Wireless-PSK	14988 (Mikrotik)	16	string	Access-Accept	
Mikrotik-Total-Limit	14988 (Mikrotik)	17	integer	Access-Accept	
Mikrotik-Total-Limit-Gigawords	14988 (Mikrotik)	18	integer	Access-Accept	
Mikrotik-Address-List	14988 (Mikrotik)	19	string	Access-Accept	
Mikrotik-Wireless-MPKey	14988 (Mikrotik)	20	string	Access-Accept	
Mikrotik-Wireless-Comment	14988 (Mikrotik)	21	string	Access-Accept	
Mikrotik-Delegated-IPv6-Pool	14988 (Mikrotik)	22	string	Access-Accept	IPv6 pool used for Prefix Delegation.
Mikrotik-DHCP-Option-Set	14988 (Mikrotik)	23	string	Access-Accept	
Mikrotik-DHCP-Option-Param-STR1	14988 (Mikrotik)	24	string	Access-Accept	
Mikrotik-DHCP-Option-Param-STR2	14988 (Mikrotik)	25	string	Access-Accept	
Mikrotik-Wireless-VLANID	14988 (Mikrotik)	26	integer	Access-Accept	VLAN ID for the client (Wireless only).
Mikrotik-Wireless-VLANIDtype	14988 (Mikrotik)	27	
0	802.1q
1	802.1ad
	Access-Accept	VLAN ID type for the client (Wireless only). 
Mikrotik-Wireless-Minsignal	14988 (Mikrotik)	28	string	Access-Accept	
Mikrotik-Wireless-Maxsignal	14988 (Mikrotik)	29	string	Access-Accept	
Mikrotik-Switching-Filter	14988 (Mikrotik)	30	string	Access-Accept	Allows to create dynamic switch rules when authenticating clients with dot1x server.

Properties
name (string; Default: )	Name of the attribute.
packet-types (string; Default: access-accept)	

    access-accept - use this attribute in RADIUS Access-Accept messages
    access-challenge - use this attribute in RADIUS Access-Challenge messages

type-id (integer:1..255; Default: )	Attribute identification number from the specific vendor's attribute database.
value-type (string; Default: )	

    hex
    ip-address - IPv4 or IPv6 IP address
    ip6-prefix - IPv6 prefix
    macro
    string
    uint32

vendor-id (integer; Default: 0)	IANA allocated a specific enterprise identification number.
Database

Sub-menu: /user-manager database

All RADIUS-related information is stored in a separate User Manager's database configurable under the "database" sub-menu. "Enabled" and "db-path" are the only parameters that are not stored in the User Manager's database and instead are stored in the main RouterOS configuration table meaning that these parameters will be affected by the RouterOS configuration reset. The rest of the configuration, session, and payment data is stored in a separate SQLite database on the FLASH storage of the device. When performing any actions with databases, it is advised to make a backup before and after any activity.

Properties
db-path (string; Default: )	Path to the location where database files will be stored.

Read-only properties
db-size	The current size of the database.
free-disk-space	Free space left on the disk where the database is stored.

Commands
load (name)	Restore previously created backup file in .umb format.
migrate-legacy-db (database-path; overwrite)	Convert the old User Manager (from RouterOS v6 or before) to the new standard. It is possible to overwrite the current database. 
optimize-db ()	
save (name; overwrite)	Save the current state of the User Manager database.
Limitations

Sub-menu: /user-manager limitation

Limitations are used by Profiles and are linked together by Profile-Limitations. RADIUS accounting and Interim updates must be enabled to seamlessly switch between multiple limitations or disconnect active sessions when download-limit, upload-limit or uptime-limit is reached.

To disconnect already active sessions from User Manager, accept must be set to yes on the RADIUS client side. If simultaneous session limits are not unlimited (shared-users) and it has reached the maximum allowed number, then the router will try to disconnect the older user session first.

User-Manager attempts to disconnect an active session before a new user will be accepted (when the appropriate limit is set), that's why in such setups it is suggested to use 1s for /radius client timeout.


IPsec service in RouterOS does not support rate limitations.

Properties
comment (string; Default: )	Short description of the limitation.
download-limit (integer; Default: 0)	The total amount of traffic a user can download in Bytes.
name (string; Default: )	Unique name of the limitation.
rate-limit-burst-rx ()	Part of MT-Rate-Limit RADIUS attribute. Refer to Queues#SimpleQueue.
rate-limit-burst-threshold-rx ()	Part of MT-Rate-Limit RADIUS attribute. Refer to Queues#SimpleQueue.
rate-limit-burst-threshold-tx ()	Part of MT-Rate-Limit RADIUS attribute. Refer to Queues#SimpleQueue.
rate-limit-burst-time-rx ()	Part of MT-Rate-Limit RADIUS attribute. Refer to Queues#SimpleQueue.
rate-limit-burst-time-tx ()	Part of MT-Rate-Limit RADIUS attribute. Refer to Queues#SimpleQueue.
rate-limit-burst-tx ()	Part of MT-Rate-Limit RADIUS attribute. Refer to Queues#SimpleQueue.
rate-limit-min-rx ()	Part of MT-Rate-Limit RADIUS attribute. Refer to Queues#SimpleQueue.
rate-limit-min-tx ()	Part of MT-Rate-Limit RADIUS attribute. Refer to Queues#SimpleQueue.
rate-limit-priority ()	Part of MT-Rate-Limit RADIUS attribute. Refer to Queues#SimpleQueue.
rate-limit-rx ()	Part of MT-Rate-Limit RADIUS attribute. Refer to Queues#SimpleQueue.
rate-limit-tx ()	Part of MT-Rate-Limit RADIUS attribute. Refer to Queues#SimpleQueue.
reset-counters-interval (hourly | daily | weekly | monthly | disabled); Default: disabled)	The interval from reset-counters-start-time when all associated user statistics are cleared.
reset-counters-start-time (datetime; Default: )	Static date and time value from which reset-counters-interval is calculated.
transfer-limit (integer; Default: 0)	The total amount of aggregated (download+upload) traffic in Bytes.
upload-limit (integer; Default: 0)	The total amount of traffic a user can upload in Bytes.
uptime-limit (time; Default: 00:00:00)	The total amount of uptime a user can stay active.
Payments

Sub-menu: /user-manager payment

Information about all received payments is available in this section.

Read-only properties
currency (string)	The currency used in the transaction.
method (string)	Service used for the transaction (currently PayPal only).
price (decimal)	Amount paid by the user.
profile (profile)	Name of the profile the user purchased.
trans-end (datetime)	Date and time when the transaction started.
trans-start (datetime)	Date and time when the transaction ended.
trans-status (string)	Status of the transaction. Possible statuses - started, pending, approved, declined, error, timeout, aborted, user approved. Only approved should be considered as a complete transaction.
user (string; Default: )	Name of the user who performed the transaction.
user-message (string; Default: )	
Profiles

Sub-menu: /user-manager profile

Properties
comment (string; Default: )	Short description of the entry.
name (string; Default: )	Unique name of the profile.
name-for-users (string; Default: )	Name of the profile that will be shown for users on the Web page.
override-shared-users (decimal | off | unlimited; Default: off)	Whether to allow multiple sessions with the same user name. This overrides the shared-users setting.
price (decimal; Default: 0.00)	
starts-when (assigned | first-auth; Default: assigned)	The time when does the profile become active. Assigned - immediately when a User Profile entry is created. First-auth - upon first authentication request from the user.
validity (time | unlimited; Default: unlimited)	The total amount of time a user can use this profile.
Profile Limitations

Sub-menu: /user-manager profile-limitation

Profile-Limitations table links Limitations and Profiles together and defines their validity period. When multiple Limitations are assigned to the same Profile, a user must comply with all Limitations for the session to be established. This allows more complicated setups to be created, for example, separate monthly and daily bandwidth limits.

Properties
comment (string; Default: )	Short description of the entry.
from-time (time; Default: 00:00:00)	Time of day when the limitation should start.
limitation (limitation; Default: )	Name of already created Limitation.
profile (profile; Default: )	Name of already created Profile.
till-time (time; Default: 23:59:59)	Time of day when the limitation should end.
weekdays (day of week; Default: Sunday, Monday, Tuesday, Wednesday, Thursday, Friday, Saturday)	Day of the week when the limitation should be active.
Routers

Sub-menu: /user-manager router

Here you can define NAS devices that can use User Manager as a RADIUS server.

Properties
coa-port (integer:1..65535; Default: 3799)	Port number of CoA (Change of Authorization) communication.
address (IP/IPv6; Default: )	IP address of the RADIUS client.
comment (string; Default: )	Short description of the NAS.
disabled (yes | no; Default: no)	Controls whether the entry is currently active or not.
name (string; Default: )	Unique name of the RADIUS client.
shared-secret (string; Default: )	Used to secure communication between a RADIUS server and a RADIUS client.

Commands
reset-counters ()	Clear all statistics for specific RADIUS client.
Sessions

Sub-menu: /user-manager session

Sessions are logged only if accounting is enabled on NAS.

Read-only properties
acct-session-id (string)
	Unique identification of the accounting session.
active (yes | no)
	Whether the session is currently used.
calling-station-id (string)	User's identifier, usually IP address or MAC address.
download (Bytes)	Amount of traffic downloaded.
ended (datetime)	Date and time when the session was closed. Empty for active sessions.
last-accounting-packet (datetime)	Date and time when the last accounting update was received.
nas-ip-address (IP address)	The IP address of the NAS.
nas-port-id (string)	Identifier of the NAS port that is authenticating the user. 
nas-port-type (string)	The port type (physical or virtual) that is authenticating the user. 
started (datetime)	Date and time when the session was established.
status (list of statuses)	Possible available statuses of a session: start - accounting message Start has been received, stop - accounting message Stop has been received, interim - Interim update has been received, close-acked - session is successfully closed, expired.
terminate-cause (string)	The reason why the session was closed.
upload (Bytes)	Amount of traffic uploaded.
uptime (time)	Total logged uptime on the session.
user (string)	Name of the user.
user-address (IP address)	IP address provided to the user.
Settings

Sub-menu: /user-manager

Properties
accounting-port (integer; Default: 1813)	Port to listen for RADIUS accounting requests.
authentication-port (integer; Default: 1812)	Port to listen for RADIUS authentication requests.
certificate (certificate; Default: )	Certificate for use in EAP TLS-type authentication methods.
enabled (yes | no; Default: no)	Whether the User Manager functionality is enabled.
use-profiles (yes | no; Default: no)	Whether to use Profiles and Limitations. When set to no, only User configuration is required to run User Manager.
Advanced

Sub-menu: /user-manager advanced

Properties
paypal-allow (yes | no; Default: no)	Whether to enable PayPal functionality for User Manager.
paypal-currency (string; Default: USD)	The currency related to price setting in which users will be billed.
paypal-password (string; Default: )	The password of your PayPal API account.
paypal-signature (string; Default: )	Signature of your PayPal API account.
paypal-use-sandbox (yes | no; Default: no)	Whether to use PayPal's sandbox environment for testing purposes.
paypal-user (string; Default: )	Username of your PayPal API account.
web-private-password (string; Default: )	Password for accessing /um/PRIVATE/ section over HTTP.
web-private-username (string; Default: )	Username for accessing /um/PRIVATE/ section over HTTP.
Users

Sub-menu: /user-manager user

Properties
attributes (array of attributes; Default: )	Custom set of Attributes with their values that will additionally be added to Access-Accept messages.
caller-id (string; Default: )	Allow user's authentication with a specific Calling-Station-Id value.
comment (string; Default: )	Short description of the user.
disabled (yes | no; Default: no)	Controls whether the user can be used or not.
group (group; Default: default)	Name of the Group the user is associated to.
name (string; Default: )	Username for session authentication.
otp-secret (string; Default: )	A one-time password token that is attached to the password.
password (string; Default: )	The password of the user for session authentication.
shared-users (integer | unlimited; Default: 1)	The total amount of sessions the user can simultaneously establish.

Commands
add-batch-users ()	The command can generate multiple user accounts based on various parameters.
generate-voucher ()	Generates a file based on voucher-template that can be presented to the end user.
monitor ()	Shows total statistics for a user. Stats include total-uptime, total-download, total-upload, active-sessions, actual-profile, attributes-details.
User Groups

Sub-menu: /user-manager user group

User groups define common characteristics of multiple users such as allowed authentication methods and RADIUS attributes. There are two groups already present in User Manager called default and default-anonymous.

Properties
attributes (array of attributes; Default: )	Custom set of Attributes with their values that will additionally be added to Access-Accept messages for users in this group.
comment (string; Default: )	Short description of the group.
inner-auths (list of auths; Default: )	List of allowed authentication methods for tunneled (outer) authentication methods. Supported inner authentication methods - ttls-pap, ttls-chap, ttls-mschap1, ttls-mschap2, peap-mschap2.
name (string; Default: )	Unique name of the group.
outer-auths (list of auths; Default: )	List of allowed authentication methods. Supported outer authentication methods - pap, chap, mschap1, mschap2, eap-tls, eap-ttls, eap-peap, eap-mschap2.
User Profiles

Sub-menu: /user-manager user-profile

This menu assigns users a profile and tracks the status of the profile. A single user can have multiple profiles assigned, however, only one can be used at the same time. A user will seamlessly be switched to the next profile when the currently active profile expires without dropping the user's session.

Properties
profile (profile; Default: )	Name of the profile to assign for user.
user (user; Default: )	Name of the user to use particular profile.

Read-only properties
end-time (datetime)
	Date and time the User Profile will expire.
state (running active | running | used)
	The current state of the User Profile. Running active - currently used profile by the user. Running - a profile is ready to be used. Used - an expired profile that can no longer be activated.

Commands
activate-user-profile ()	Make a User Profile entry active immediately.
WEB Interface

Each user has access to his personal profile using a WEB interface. The WEB interface can be accessed by adding "/um/" directory to the router's IP or domain, for example, http://example.com/um/. Note that the WEB interface is affected by IP Services "www" and "www-ssl". The WEB interface can be customized using CSS, JavaScript, and HTML.

Customizable file reference
css/login.css	Cascading style sheet file used in login prompt page.
css/user.css	Cascading style sheet file used in user's profile page.
img/PayPal_mark_37x23.gif	PayPal logo image.
img/ajax-loader.gif	Loading gif while processing page switching.
img/mikrotik_logo.png	MikroTik logo that is displayed on all pages.
js/generic.js	Javascript file used on all pages.
js/login.js	Javascript file used in login prompt page.
js/user.js	Javascript file used in user's profile page.
user/login_dynamic.html	Layout of the login prompt page.
user/user_dynamic.html	Layout of the user's profile page.
Application Guides
Batch user creation

It is possible to create multiple new users with randomly generated usernames and passwords. For example, the following command will generate 3 new users with 6 lowercase symbols as the username and 6 lowercase, uppercase, and numbers as the password.
/user-manager user
add-batch-users number-of-users=3 password-characters=lowercase,numbers,uppercase password-length=6 username-characters=lowercase username-length=6

The command generated users can be seen by printing the user's table:
/user-manager user print 
Flags: X - disabled 
 0   name="olsgkl" password="86a6zH" otp-secret="" group=default shared-users=1 attributes="" 

 1   name="lkbwss" password="jaKY5V" otp-secret="" group=default shared-users=1 attributes="" 

 2   name="cwxbwu" password="a62yZd" otp-secret="" group=default shared-users=1 attributes="" 

Providing NAS with custom RADIUS attributes

It is possible to send additional RADIUS attributes during the authentication process to provide NAS with custom information about the session, such as what IP address should be assigned to the supplicant or what address pool to use for address assigning.
Static IP address for a user

To assign the end user a static IP address, Framed-IP-Address attribute can be used. When using static IP address allocation, shared-sessions must be set to 1 to prevent cases when a user has multiple simultaneous sessions, but there is only one IP address. For example:
/user-manager user
set [find name=username] shared-users=1 attributes=Framed-IP-Address:192.168.1.4
Specifying address pool for a group of users

We can group up multiple similar users and assign RADIUS attributes to all of them at once. First of all, create a new group:
/user-manager user group
add name=location1 outer-auths=chap,eap-mschap2,eap-peap,eap-tls,eap-ttls,mschap1,mschap2,pap \
inner-auths=peap-mschap2,ttls-chap,ttls-mschap1,ttls-mschap2,ttls-pap attributes=Framed-Pool:pool1

The next step is to assign a user to the group:
/user-manager user
 set [find name=username] group=location1

In this case, an IP address from pool1 will be assigned to the user upon authentication - make sure pool1 is created on the NAS device.
Using TOTP (time-based one-time password) for user authentication

User Manager supports time-based authentication token addition to the user's password field that is regenerated every 30 seconds.

OTP depends on the clock, so make sure time settings are configured correctly.

TOTP works by having a shared secret on the supplicant (client) and the authentication server (User Manager). To configure TOTP on RouterOS, simply set the otp-secret for the user. For example:
/user-manager user
set [find name=username] password=mypass otp-secret=mysecret

To calculate the TOTP token on the supplicant side, many widely available applications can be used, for example, Google Authenticator or https://totp.app/. Adding mysecret to the TOTP token generator will provide a new unique 6-digit code that must be added to the user password.

The following example will accept the user's authentication with a calculated TOTP token added to the common password until a new TOTP token is generated, for example,
User-Name=username
User-Password=mypass620872
Exporting user credentials
Printable login credentials for a single user

To generate a single user's printable voucher card, simply use the generate-voucher command. Specify the RouterOS ID number of the user or use the find command to specify a username. A template is already included in User Manager's installation available in the Files section of your device. You can customize the template for your needs.
/user-manager user
generate-voucher voucher-template=printable_vouchers.html [find where name=username]

The generated voucher card is available by accessing the router using a WEB browser and navigating to /um/PRIVATE/GENERATED/vouchers/gen_printable_vouchers.html

By default, the printable card looks like this:

To access the PRIVATE path of the /um/ directory by the WEB browser, private-username and private-password must be configured. See Settings section.

It is possible to use different variables when generating vouchers. Currently, supported variables are:

$(username) - Represents User Manager username
$(password) - Password of the username
$(userprofname) - Profile that is active for the particular user
$(userprofendtime) - Profile validity end time if specified
Multiple user credential export

It is possible to generate a CSV or XML file with multiple or all user credentials at once by using the export.xml or export.csv as voucher-template.
/user-manager user
generate-voucher voucher-template=export.xml [find]

The command generates an XML file um5files/PRIVATE/GENERATED/vouchers/gen_export.xml which can either be accessible by the WEB browser or any other file access tools.
<?xml version="1.0" encoding="UTF-8"?>
<users>
    <user>
        <username>olsgkl</username>
        <password>86a6zH</password>
    </user>
    <user>
        <username>lkbwss</username>
        <password>jaKY5V</password>
    </user>
    <user>
        <username>cwxbwu</username>
        <password>a62yZd</password>
    </user>
    <user>
        <username>username</username>
        <password>secretpassword</password>
    </user>

</users>
Generating usage report

In cases where presentable network usage information is required by companies billing or legal team an automated session export can be created using the generate-report command. The command requires an input of the report template - an example of the template is available in um5files/PRIVATE/TEMPLATES/reports/report_default.html. Example of the report generation:
/user-manager
generate-report report-template=report_default.html columns=username,uptime,download,upload

The generated report is available by accessing the router using a WEB browser and navigating to /um/PRIVATE/GENERATED/reports/gen_report_default.html

Purchasing a profile

After logging into the user's private profile by accessing the router's /um/ directory using a WEB browser, for example, http://example.com/um/, he will be able to see all available Profiles in the respective menu. Profiles that have specified price values will have a Buy this Profile button available.

After pressing the Buy this Profile button, the user will be asked to choose from available transaction service providers (currently only PayPal is available) and later redirected to PayPal's payment processing page.

When the payment is completed, the User Manager will ask PayPal to approve the transaction. After approval, the profile is assigned to the user and is ready to use.
Migrating from RouterOS v6


When you upgrade your User Manager router from RouterOS v6 to the v7 the new User Manager will work with new database files and configuration. To continue using the old user, router, profile, etc. configuration you must manually execute the migrate command. To do so you must have files from the old User Manager server folder "user-manager" present. The folder can be renamed, but all the contents from the old installation must be transferred to the new v7 installation (you can move the old configuration from one router to another router with v7, you must copy "user-manager" folder). After that, all you need to do is execute this command - "/user-manager/database/migrate-legacy-db database-path=<path_to_old_user_manager_folder>".

The import process will try to convert such configuration - users, profiles, user-profiles, limitations, profile-limitations, user-counters, routers, and sessions.
Application Examples
Basic L2TP/IPsec server with User Manager authentication

User Manager configuration

Start off by enabling User Manager functionality.
/user-manager
set enabled=yes

Allow receiving RADIUS requests from the localhost (the router itself).
/user-manager router
add address=127.0.0.1 comment=localhost name=local shared-secret=test

Next, add users and their credentials that clients will use to authenticate to the server.
/user-manager user
add name=user1 password=password

Configuring RADIUS client

For the router to use the RADIUS server for user authentication, it is required to add a new RADIUS client that has the same shared secret that we already configured on User Manager.
/radius
add address=127.0.0.1 secret=test service=ipsec

L2TP/IPsec server configuration

Configure the IP pool from which IP addresses will be assigned to the users and assign it to the PPP Profile.
/ip pool
add name=vpn-pool range=192.168.99.2-192.168.99.100

/ppp profile
set default-encryption local-address=192.168.99.1 remote-address=vpn-pool

Enable the use of RADIUS for PPP authentication.
/ppp aaa
set use-radius=yes

Enable the L2TP server with IPsec encryption.
/interface l2tp-server server
set enabled=yes use-ipsec=required ipsec-secret=mySecret

That is it. Your router is now ready to accept L2TP/IPsec connections and authenticate them to the internal User Manager.
MFA authentication for RouterOS user login

As User-Manager supports TOTP (time-based-one-time password), it is possible to setup so called MFA authentication for different services. Here will will look into RouterOS user authentication over User Manager (radius) with time based password, that is changed every 30 seconds. 

Here are the necessary configuration options on your MikroTik router,

Enable to use RADIUS for /user menu, and set default-grop from /user group menu. Keep in mind that local /user database is checked first, and then RADIUS is contacted.
 

/user/aaa/set use-radius=yes default-group=full

Enable radius client for login service. As we run User Manager on the same router, 127.0.0.1 is used,

/radius/add address=127.0.0.1 service=login secret=mystrongsecret

Here are the configuration steps for User Manager,

Make sure you have added your managed devices to "Routers" menu,

/user-manager/router/add name=myrouter address=127.0.0.1 shared-secret=mystrongsecret

Add user to User-Manager user table with OTP secret parameter. Few more steps are required for proper OTP configuration.
Pick OTP-secret name and convert it to base32 format (there are plenty of online converters from utf-8 to base32 format). For my configuration I use "mysupersecret", that in base32 would be NV4XG5LQMVZHGZLDOJSXI===

/user-manager/user/add name=mikrotik password=mysuperpassword otp-secret="NV4XG5LQMVZHGZLDOJSXI==="

Note, than in your favorite authenticator app, you will need to set user this key manually "NV4XG5LQMVZHGZLDOJSXI===", when adding new time password instance.

To login to your MikroTik device, open Winbox/Console and connect to your router address, use login:mikrotik and password:mysuperpasswordxxxxxx, where xxxxxx is 6 digit code from your favorite authentication app.

Password is changed every 30 seconds and it is available from your favorite app.

